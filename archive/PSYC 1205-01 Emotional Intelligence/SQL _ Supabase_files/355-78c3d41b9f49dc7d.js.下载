"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[355],{83784:function(e,t,n){n.d(t,{Z:function(){return b}});var r=n(97458),l=n(32691),s=n(52983),o=n(34549),a=n(73512),i=n(3297),c=n(42667),d=n(15011),u=n(15518),m=n(37914),h=n(28289),p=n(60661),x=n(53486);let f=e=>{let{visible:t,onCancel:n,onSubmit:l,initialValues:s}=e;return(0,r.jsx)(m.Z,{visible:t,onCancel:n,hideFooter:!0,header:"Update saved query",size:"medium",children:(0,r.jsx)(h.Z,{onReset:n,validateOnBlur:!0,initialValues:s,validate:function(e){let t={};return e.name||(t.name="Required"),t},onSubmit:l,children:e=>{let{isSubmitting:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z.Content,{children:(0,r.jsx)(p.Z,{label:"Name",id:"name",name:"name"})}),(0,r.jsx)(m.Z.Content,{children:(0,r.jsx)(p.Z.TextArea,{label:"Description",id:"description",placeholder:"Describe query",size:"medium",textAreaClassName:"resize-none"})}),(0,r.jsx)(m.Z.Separator,{}),(0,r.jsxs)(m.Z.Content,{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(x.z,{htmlType:"reset",type:"default",onClick:n,disabled:t,children:"Cancel"}),(0,r.jsx)(x.z,{htmlType:"submit",loading:t,disabled:t,children:"Save query"})]})]})}})})};var g=n(48631),j=n(26597),v=n(27735),y=n(95827),b=e=>{let{item:t}=e,n=(0,l.useRouter)(),{ref:m}=(0,a.UO)(),[h,p]=(0,s.useState)(!1),[x,b]=(0,s.useState)(!1),{mutate:w}=(0,i.z)({onSuccess:()=>{p(!1),o.Am.success("Successfully deleted query")},onError:e=>{o.Am.error("Failed to delete saved query: ".concat(e.message))}}),{mutate:C}=(0,c.R)({onSuccess:()=>{b(!1),o.Am.success("Successfully updated query")},onError:e=>{o.Am.error("Failed to update query: ".concat(e.message))}}),k=async()=>{if(!m||"string"!=typeof m)return console.error("Invalid project reference");w({projectRef:m,ids:[t.id]})},N=async e=>{let{name:n,description:r}=e;if(!m||"string"!=typeof m)return console.error("Invalid project reference");C({projectRef:m,payload:{...t,name:n,description:r||void 0,type:"log_sql",visibility:"user"}})},S=n.query.queryId===t.id;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.k,{label:t.name,icon:(0,r.jsx)(v.vu,{size:"15"}),href:"/project/".concat(m,"/logs/explorer?queryId=").concat(encodeURIComponent(t.id),"&q=").concat(encodeURIComponent(t.content.sql)),isActive:S,dropdownItems:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(d.Xi,{onClick:()=>b(!0),children:[(0,r.jsx)(g.Z,{size:14,className:"mr-2"}),"Edit query"]}),(0,r.jsx)(d.VD,{}),(0,r.jsxs)(d.Xi,{onClick:()=>{p(!0)},children:[(0,r.jsx)(j.Z,{size:14,className:"mr-2"}),"Delete query"]})]})}),(0,r.jsx)(u.Z,{variant:"destructive",visible:h,confirmLabel:"Delete query",title:"Confirm to delete saved query",onCancel:()=>{p(!1)},onConfirm:k,children:(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to delete ",t.name,"?"]})}),(0,r.jsx)(f,{visible:x,initialValues:{name:t.name,description:t.description},onCancel:()=>{b(!1)},onSubmit:e=>{N(e)}})]})}},95827:function(e,t,n){n.d(t,{k:function(){return d}});var r=n(97458),l=n(75365),s=n(83145),o=n.n(s),a=n(43633),i=n(15011),c=n(53486);function d(e){let{label:t,icon:n,dropdownItems:s,href:d,isActive:u,onClick:m}=e;return(0,r.jsxs)("div",{className:(0,a.cn)({"bg-foreground-lighter/10":u},"relative flex [&:has([data-state=open])]:bg-foreground-lighter/10 [&:has([data-state=open])]:text-foreground hover:text-foreground hover:bg-foreground-lighter/10 transition-all text-foreground-light group"),children:[(0,r.jsxs)(o(),{onClick:m,href:d,className:"h-7 flex-1 text-sm px-4 flex items-center gap-2 truncate",children:[(0,r.jsx)("span",{children:n}),(0,r.jsx)("span",{className:"truncate",children:t})]}),s&&(0,r.jsxs)(i.h_,{children:[(0,r.jsx)(i.$F,{asChild:!0,onClick:e=>{e.preventDefault()},children:(0,r.jsx)(c.z,{type:"text",title:"Actions",className:"space-x-0 h-7 px-1.5 opacity-0 group-hover:opacity-100 !bg-transparent data-[state=open]:opacity-100",icon:(0,r.jsx)(l.Z,{size:14}),children:(0,r.jsx)("div",{className:"sr-only",children:"Actions"})})}),(0,r.jsx)(i.AW,{className:"w-48",align:"end",children:s})]})]})}},38057:function(e,t,n){n.d(t,{Z:function(){return C}});var r=n(97458),l=n(73512),s=n(26328),o=n(78859),a=n(88803),i=n(3666),c=n(7350),d=n(16696),u=n(65206),m=n(83145),h=n.n(m),p=n(32691),x=n(52983),f=n(56535),g=n(43633),j=n(53486),v=n(78978),y=n(95909),b=()=>{let e=(0,p.useRouter)(),[t,n]=(0,x.useState)(!1),{ref:s}=(0,l.UO)();return(0,r.jsxs)("div",{className:"h-14 w-full flex flex-row md:hidden",children:[(0,r.jsxs)("nav",{className:(0,g.cn)("group px-4 z-10 w-full h-14","border-b bg-dash-sidebar border-default shadow-xl","transition-width duration-200","hide-scrollbar flex flex-row items-center justify-between overflow-x-auto"),children:[(0,r.jsx)(h(),{href:f.Qy?"/projects":"/project/".concat(s),className:"flex items-center h-[26px] w-[26px] min-w-[26px]",children:(0,r.jsx)("img",{alt:"Supabase",src:"".concat(e.basePath,"/img/supabase-logo.svg"),className:"absolute h-[26px] w-[26px] cursor-pointer rounded"})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(v.av,{children:(0,r.jsx)("button",{className:(0,g.cn)("group","flex-grow h-[30px] rounded-md","p-2","flex items-center justify-between","bg-transparent border-none text-foreground-lighter","hover:bg-opacity-100 hover:border-strong hover:text-foreground-light","focus-visible:!outline-4 focus-visible:outline-offset-1 focus-visible:outline-brand-600","transition"),children:(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsx)(d.Z,{size:18,strokeWidth:2})})})}),(0,r.jsx)("button",{title:"Menu dropdown button",className:(0,g.cn)((0,j.d)({type:"default"}),"flex lg:hidden border-default bg-surface-100/75 text-foreground-light rounded-md min-w-[30px] w-[30px] h-[30px] data-[state=open]:bg-overlay-hover/30"),onClick:()=>n(!0),children:(0,r.jsx)(u.Z,{size:18,strokeWidth:1})})]})]}),(0,r.jsx)(y.Z,{open:t,onOpenChange:n,"data-state":"expanded",children:(0,r.jsx)(a.TZ,{})})]})},w=n(32672),C=e=>{let{children:t,showProductMenu:n}=e,{ref:d}=(0,l.UO)();return(0,r.jsx)(i.Hn,{defaultOpen:!1,children:(0,r.jsx)(w.Ml,{projectRef:d,children:(0,r.jsx)(o.EA,{children:(0,r.jsxs)("div",{className:"flex flex-col h-screen w-screen",children:[(0,r.jsx)(s.l,{}),(0,r.jsxs)("div",{className:"flex-shrink-0",children:[(0,r.jsx)(b,{}),(0,r.jsx)(c.N,{showProductMenu:n})]}),(0,r.jsxs)("div",{className:"flex flex-1 w-full overflow-y-hidden",children:[(0,r.jsx)(a.YE,{}),(0,r.jsx)("div",{className:"flex-grow h-full overflow-y-auto",children:t})]})]})})})})}},46406:function(e,t,n){n.d(t,{Z:function(){return em}});var r=n(97458),l=n(40540),s=n(32691),o=n(52983),a=n(37315),i=n(94281),c=n(35721),d=n(76026),u=n(56535),m=n(15631),h=n(86817),p=n(4534),x=n(91001),f=n(83145),g=n.n(f),j=n(73512),v=n(34549),y=n(36457),b=n(64618),w=n(129),C=n(67789);async function k(e){let{projectRef:t,name:n,retention_days:r}=e,{data:l,error:s}=await (0,w.v_)("/platform/projects/{ref}/analytics/warehouse/collections",{params:{path:{ref:t}},body:{name:n,retention_days:r}});return s&&(0,w.S3)(s),l}let N=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,y.NL)();return(0,b.D)(e=>{var t;let n=null===(t=r.getQueryData(C.d.warehouseCollections(e.projectRef)))||void 0===t?void 0:t.map(e=>e.name);if(null==n?void 0:n.includes(e.name))throw Error("Collection with the name ".concat(e.name," already exists"));return k(e)},{async onSuccess(t,n,l){let{projectRef:s}=n;await r.invalidateQueries(C.d.warehouseCollections(s)),await (null==e?void 0:e(t,n,l))},async onError(e,n,r){void 0===t?v.Am.error("Failed to create collection: ".concat(e.message)):t(e,n,r)},...n})};var S=n(37914),Z=n(90330),_=n(86848),A=n(5394),z=n(76707),R=n(93840),E=n(53486),F=n(59225),q=n(47983),D=n(27429),L=n(9881);let V=e=>{let{initialValues:t,onSubmit:n,isLoading:l,onCancelClick:o}=e,{plan:a,isLoading:i}=(0,q.a)(),c=(0,s.useRouter)(),d=(0,L.l)(),u=i?1:(null==a?void 0:a.id)==="free"?3:90,m=A.z.object({name:A.z.string().min(1),retention_days:A.z.coerce.number().min(1).max(u).multipleOf(1).positive().int()}),h=(0,_.cI)({resolver:(0,Z.F)(m),defaultValues:{name:(null==t?void 0:t.name)||"",retention_days:(null==t?void 0:t.retention_days)||u}}),p=h.handleSubmit(n),x=e=>1===e?"1 day":"".concat(e," days"),f=e=>!e||e<1?(0,r.jsxs)(r.Fragment,{children:["Your plan allows for a maximum of ",x(u),"."]}):(0,r.jsxs)(r.Fragment,{children:["Your logs will be removed after ",x(e),". ",(0,r.jsx)("br",{}),"Your plan allows for a maximum of ",x(u),"."]});return(0,r.jsx)(z.l0,{...h,children:(0,r.jsxs)("form",{onSubmit:p,children:[(0,r.jsxs)(S.Z.Content,{className:"space-y-3",children:[(0,r.jsx)(z.Wi,{control:h.control,name:"name",render:e=>{let{field:t}=e;return(0,r.jsx)(F.E,{label:"Collection name",layout:"horizontal",children:(0,r.jsx)(z.NI,{children:(0,r.jsx)(R.I,{autoFocus:!0,placeholder:"Events",...t})})})}}),(0,r.jsx)(z.Wi,{control:h.control,name:"retention_days",render:e=>{let{field:t}=e;return(0,r.jsx)(F.E,{label:"Retention",layout:"horizontal",description:f(Number(t.value)),children:(0,r.jsx)(z.NI,{children:(0,r.jsxs)("div",{className:"relative flex items-center gap-2",children:[(0,r.jsx)(R.I,{type:"number",...t}),(0,r.jsx)("span",{className:"absolute right-3 text-foreground-lighter text-sm pointer-events-none",children:"days"})]})})})}})]}),(null==a?void 0:a.id)==="free"&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.Z.Separator,{}),(0,r.jsx)(D.J,{className:"border-none bg-transparent",type:"default",title:"Upgrade your plan to increase retention",description:(0,r.jsxs)("div",{children:["Upgrade to the pro plan to increase retention to 90 days.",(0,r.jsx)(E.z,{className:"mt-2",type:"primary",onClick:()=>c.push("/org/".concat(null==d?void 0:d.slug,"/billing?panel=subscriptionPlan&source=dataWarehouseIncreaseRetention")),children:"Upgrade plan"})]})})]}),(0,r.jsx)(z.zG,{}),(0,r.jsxs)(S.Z.Content,{className:"py-4 border-t flex items-center justify-end gap-2",children:[(0,r.jsx)(E.z,{size:"tiny",type:"default",onClick:o,children:"Cancel"}),(0,r.jsx)(E.z,{size:"tiny",loading:l,disabled:l,htmlType:"submit",children:"Create collection"})]})]})})},I=e=>{let{open:t,onOpenChange:n}=e,l=(0,s.useRouter)(),{ref:o}=(0,j.UO)(),{mutate:a,isLoading:i}=N({onSuccess:e=>{n(!1),v.Am.success("Collection created successfully"),l.push("/project/".concat(o,"/logs/collections/").concat(e.token))},onError:e=>{v.Am.error(e.message)}});return(0,r.jsx)(S.Z,{size:"medium",onCancel:()=>n(!1),header:"Create collection",visible:t,hideFooter:!0,children:(0,r.jsx)(V,{onCancelClick:()=>n(!1),isLoading:i,onSubmit:e=>{o&&a({projectRef:o,name:e.name,retention_days:e.retention_days})}})})};var O=n(13826),T=n(48631),M=n(26597);async function U(e){let{projectRef:t,collectionToken:n}=e,{data:r,error:l}=await (0,w.IV)("/platform/projects/{ref}/analytics/warehouse/collections/{token}",{params:{path:{ref:t,token:n}}});return l&&(0,w.S3)(l),r}let P=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,y.NL)();return(0,b.D)(e=>U(e),{async onSuccess(t,n,l){let{projectRef:s}=n;await r.invalidateQueries(C.d.warehouseCollections(s)),await (null==e?void 0:e(t,n,l))},async onError(e,n,r){void 0===t?v.Am.error("Failed to delete collection: ".concat(e.message)):t(e,n,r)},...n})};async function Q(e,t){let{projectRef:n,collectionToken:r}=e,{data:l,error:s}=await (0,w.r$)("/platform/projects/{ref}/analytics/warehouse/collections/{token}",{params:{path:{ref:n,token:r}},body:t});return s&&(0,w.S3)(s),l}let W=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,y.NL)();return(0,b.D)(e=>Q({projectRef:e.projectRef,collectionToken:e.collectionToken},{name:e.name,retention_days:e.retention_days}),{async onSuccess(t,n,l){let{projectRef:s}=n;await r.invalidateQueries(C.d.warehouseCollections(s)),await (null==e?void 0:e(t,n,l))},async onError(e,n,r){void 0===t?v.Am.error("Failed to update collection: ".concat(e.message)):t(e,n,r)},...n})};var Y=n(50322),B=n(15011),X=n(15518),G=n(95827);let H=e=>{let{item:t}=e,n=(0,s.useRouter)(),{ref:a,collectionToken:c}=(0,j.UO)(),d=a||"default",[u,m]=(0,o.useState)(!1),[h,p]=(0,o.useState)(!1),x=(0,i.Xo)(l.KA.ANALYTICS_WRITE,"logflare"),f=W({onSuccess:()=>{v.Am.success("Collection updated successfully"),m(!1)}}),g=P({onSuccess:()=>{t.token===c&&n.push("/project/".concat(d,"/logs/explorer")),p(!1),v.Am.success("Collection deleted successfully")}}),y=f.isLoading||g.isLoading;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(G.k,{isActive:t.token===c,label:t.name,icon:(0,r.jsx)(O.Z,{size:"14",className:"text-foreground-light"}),href:"/project/".concat(d,"/logs/collections/").concat(t.token),dropdownItems:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(Y.u,{children:[(0,r.jsx)(Y.aJ,{asChild:!0,children:(0,r.jsxs)(B.Xi,{disabled:!x,onClick:e=>{e.preventDefault(),m(!0)},children:[(0,r.jsx)(T.Z,{className:"mr-2",size:14}),(0,r.jsx)("div",{children:"Update collection"})]})}),!x&&(0,r.jsx)(Y._v,{side:"right",children:"You need additional permissions to update collections"})]}),(0,r.jsx)(B.VD,{}),(0,r.jsxs)(Y.u,{children:[(0,r.jsx)(Y.aJ,{asChild:!0,children:(0,r.jsxs)(B.Xi,{disabled:!x,onClick:e=>{e.preventDefault(),p(!0)},children:[(0,r.jsx)(M.Z,{className:"mr-2",size:14}),(0,r.jsx)("div",{children:"Delete collection"})]})}),!x&&(0,r.jsx)(Y._v,{side:"right",children:"You need additional permissions to delete collections"})]})]})}),(0,r.jsx)(S.Z,{size:"medium",visible:u,onCancel:()=>m(!1),hideFooter:!0,header:'Update collection "'.concat(t.name,'"'),children:(0,r.jsx)(V,{onCancelClick:()=>m(!1),isLoading:y,initialValues:{name:t.name,retention_days:t.retention_days},onSubmit:e=>{let{name:n,retention_days:r}=e;f.mutate({projectRef:d,collectionToken:t.token,name:n,retention_days:r})}})}),(0,r.jsx)(X.Z,{variant:"destructive",visible:h,onCancel:()=>p(!1),confirmLabel:"Delete collection",title:'Delete collection "'.concat(t.name,'"'),size:"small",onConfirm:()=>{g.mutate({projectRef:d,collectionToken:t.token})},children:(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["All data in this collection will be deleted.",(0,r.jsx)("br",{}),(0,r.jsx)("div",{className:"mt-2",children:"This action cannot be undone."})]})})]})};var $=n(83784),J=n(89352),K=n(28894);async function ee(e,t){let{projectRef:n}=e;if(!n)throw Error("projectRef is required");let{data:r,error:l}=await (0,w.U2)("/platform/projects/{ref}/analytics/warehouse/tenant",{params:{path:{ref:n}},signal:t});return l&&(0,w.S3)(l),r}let et=function(e){let{projectRef:t}=e,{enabled:n=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,K.a)(C.d.warehouseTenant(t),e=>{let{signal:n}=e;return ee({projectRef:t},n)},{enabled:n&&!!t&&u.Qy,staleTime:1/0,cacheTime:72e5,refetchOnMount:!1,refetchInterval:!1,...r})};var en=n(60516),er=n(20424),el=n(30114),es=n(67976),eo=n(47889),ea=n(5817),ei=n(28179);let ec=e=>{let{className:t}=e;return(0,r.jsx)("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 24 24",height:"15px",width:"15px",className:t,xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M10.9997 2.59833V13.9694H3.90013C3.23055 13.9694 2.83063 13.1846 3.25654 12.6326L10.9997 2.59833ZM12.9997 8.03061V2.33296C12.9997 0.521514 10.7034 -0.291434 9.58194 1.16185L1.67316 11.4108C0.246185 13.26 1.54768 15.9694 3.90013 15.9694H10.9997V21.6671C10.9997 23.4785 13.296 24.2915 14.4175 22.8382L22.3262 12.5892C23.7532 10.74 22.4517 8.03061 20.0993 8.03061H12.9997ZM12.9997 10.0306H20.0993C20.7688 10.0306 21.1688 10.8155 20.7429 11.3674L12.9997 21.4017V10.0306Z"})})};function ed(e){let{children:t,title:n,defaultOpen:l}=e;return(0,r.jsxs)(es.zF,{defaultOpen:l,children:[(0,r.jsxs)(es.wy,{className:"flex items-center gap-x-2 px-4 [&[data-state=open]>svg]:!rotate-90 pb-2",children:[(0,r.jsx)(h.Z,{size:16,className:"text-foreground-light transition-transform duration-200"}),(0,r.jsx)("span",{className:"text-foreground-light font-mono text-sm uppercase",children:n})]}),(0,r.jsx)(es.Fw,{children:t})]})}function eu(){var e;let[t,n]=(0,o.useState)(""),[a,c]=(0,o.useState)(!1),d=(0,i.Xo)(l.KA.ANALYTICS_WRITE,"logflare"),u=(0,s.useRouter)(),{ref:m}=(0,j.UO)(),{data:h}=et({projectRef:m}),{projectAuthAll:f,projectStorageAll:v,realtimeAll:y}=(0,er.N)(["project_storage:all","project_auth:all","realtime:all"]),b=(0,el.P)("warehouse"),{data:w,isLoading:C}=(0,J.O)({projectRef:m},{enabled:j.Qy&&b&&!!h}),{data:k,isLoading:N}=(0,en.I)({projectRef:m,type:"log_sql"}),S=[...null!==(e=null==k?void 0:k.content)&&void 0!==e?e:[]].filter(e=>"log_sql"===e.type).sort((e,t)=>e.name.localeCompare(t.name));function Z(e){return u.asPath.includes(e)}let _=[{name:"API Gateway",key:"edge-logs",url:"/project/".concat(m,"/logs/edge-logs"),items:[]},{name:"Postgres",key:"postgres-logs",url:"/project/".concat(m,"/logs/postgres-logs"),items:[]},{name:"PostgREST",key:"postgrest-logs",url:"/project/".concat(m,"/logs/postgrest-logs"),items:[]},j.Qy?{name:"Pooler",key:"pooler-logs",url:"/project/".concat(m,"/logs/pooler-logs"),items:[]}:null,,f?{name:"Auth",key:"auth-logs",url:"/project/".concat(m,"/logs/auth-logs"),items:[]}:null,v?{name:"Storage",key:"storage-logs",url:"/project/".concat(m,"/logs/storage-logs"),items:[]}:null,y?{name:"Realtime",key:"realtime-logs",url:"/project/".concat(m,"/logs/realtime-logs"),items:[]}:null,{name:"Edge Functions",key:"edge-functions-logs",url:"/project/".concat(m,"/logs/edge-functions-logs"),items:[]},{name:"Cron",key:"pg_cron",url:"/project/".concat(m,"/logs/pgcron-logs"),items:[]}].filter(e=>null==e?void 0:e.name.toLowerCase().includes(t.toLowerCase())),A=null==w?void 0:w.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()));return(0,r.jsxs)("div",{className:"pb-12 relative",children:[(0,r.jsxs)("div",{className:"flex gap-2 p-4 items-center sticky top-0 bg-background-200 z-[1]",children:[(0,r.jsx)(ea.nM,{className:"w-full p-0 gap-0",children:(0,r.jsx)(ea.nn,{name:"search-collections",placeholder:"Search collections...","aria-labelledby":"Search collections",value:t,onChange:e=>n(e.target.value)})}),(0,r.jsxs)(B.h_,{children:[(0,r.jsx)(B.$F,{asChild:!0,children:(0,r.jsx)(E.z,{type:"default",icon:(0,r.jsx)(p.Z,{className:"text-foreground"}),className:"w-[26px]"})}),(0,r.jsxs)(B.AW,{align:"end",className:"w-48",children:[(0,r.jsx)(B.Xi,{className:"gap-x-2",asChild:!0,children:(0,r.jsxs)(g(),{href:"/project/".concat(m,"/logs/explorer"),children:[(0,r.jsx)(x.Z,{size:14}),"Create query"]})}),b&&(0,r.jsxs)(Y.u,{children:[(0,r.jsx)(Y.aJ,{asChild:!0,children:(0,r.jsx)(B.Xi,{className:"gap-x-2",asChild:!0,children:(0,r.jsxs)("button",{onClick:()=>c(!0),className:"w-full flex items-center text-xs px-2 py-1",disabled:!d,children:[(0,r.jsx)(p.Z,{size:14}),"Create collection"]})})}),!d&&(0,r.jsx)(Y._v,{children:"You need additional permissions to create a collection"})]})]})]}),(0,r.jsx)(I,{open:a,onOpenChange:c})]}),(0,r.jsx)("div",{className:"px-2",children:(0,r.jsx)(ea.DS,{title:"Templates",isActive:Z("/project/".concat(m,"/logs/explorer/templates")),href:"/project/".concat(m,"/logs/explorer/templates"),children:"Templates"})}),(0,r.jsx)(eo.Z,{className:"my-4"}),(0,r.jsxs)(ed,{title:"Collections",defaultOpen:!0,children:[_.map(e=>{var t,n,l;return(0,r.jsx)(G.k,{isActive:Z(null!==(t=null==e?void 0:e.url)&&void 0!==t?t:""),href:null!==(n=null==e?void 0:e.url)&&void 0!==n?n:"",icon:(0,r.jsx)(ec,{className:"text-foreground-light"}),label:null!==(l=null==e?void 0:e.name)&&void 0!==l?l:""},null==e?void 0:e.key)}),C&&b?(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)(ei.A,{})}):(null==A?void 0:A.length)?(0,r.jsx)("div",{children:A.map(e=>(0,r.jsx)(H,{item:e},e.token))}):null]}),(0,r.jsx)(eo.Z,{className:"my-4"}),(0,r.jsxs)(ed,{title:"Queries",defaultOpen:!0,children:[N&&(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)(ei.A,{})}),0===S.length&&(0,r.jsx)(ea.Cf,{className:"mx-4",title:"No queries created yet",description:"Create and save your queries to use them in the explorer",actions:(0,r.jsx)(E.z,{asChild:!0,type:"default",children:(0,r.jsx)(g(),{href:"/project/".concat(m,"/logs/explorer"),children:"Create query"})})}),S.map(e=>(0,r.jsx)($.Z,{item:e},e.id))]})]})}var em=(0,d.Q)(e=>{let{title:t,children:n}=e,{isLoading:d,can:h}=(0,i.CD)(l.KA.ANALYTICS_READ,"logflare"),p=(0,s.useRouter)(),[x,f]=(0,c.l)(u.dA.LAST_VISITED_LOGS_PAGE,p.pathname.split("/logs/")[1]);if((0,o.useEffect)(()=>{p.pathname.includes("/logs/")&&f(p.pathname.split("/logs/")[1])},[p,f]),!h){if(d)return(0,r.jsx)(m.Z,{isLoading:!0});if(!d&&!h)return(0,r.jsx)(m.Z,{children:(0,r.jsx)(a.Z,{isFullPage:!0,resourceText:"access your project's logs"})})}return(0,r.jsx)(m.Z,{title:t,product:"Logs & Analytics",productMenu:(0,r.jsx)(eu,{}),children:n})})},37315:function(e,t,n){var r=n(97458),l=n(19369);t.Z=e=>{let{resourceText:t,isFullPage:n=!1}=e,s=()=>(0,r.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200",children:(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)(l.Z,{size:20})}),(0,r.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return n?(0,r.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,r.jsx)("div",{className:"w-[550px]",children:(0,r.jsx)(s,{})})}):(0,r.jsx)(s,{})}},89352:function(e,t,n){n.d(t,{O:function(){return i}});var r=n(28894),l=n(129),s=n(56535),o=n(67789);async function a(e,t){let{projectRef:n}=e;if(!n)throw Error("projectRef is required");let{data:r,error:s}=await (0,l.U2)("/platform/projects/{ref}/analytics/warehouse/collections",{params:{path:{ref:n}},signal:t});return s&&(0,l.S3)(s),r}let i=function(e){let{projectRef:t}=e,{enabled:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0};return(0,r.a)(o.d.warehouseCollections(t),e=>{let{signal:n}=e;return a({projectRef:t},n)},{enabled:n&&!!t&&s.Qy})}},3297:function(e,t,n){n.d(t,{z:function(){return c}});var r=n(36457),l=n(64618),s=n(34549),o=n(129),a=n(97526);async function i(e,t){let{projectRef:n,ids:r}=e,{data:l,error:s}=await (0,o.IV)("/platform/projects/{ref}/content",{headers:{Version:"2"},params:{path:{ref:n},query:{ids:r}},signal:t});return s&&(0,o.S3)(s),l.map(e=>e.id)}let c=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,r.NL)();return(0,l.D)(e=>i(e),{async onSuccess(t,n,r){let{projectRef:l}=n;await o.invalidateQueries(a.$.allContentLists(l)),await (null==e?void 0:e(t,n,r))},async onError(e,n,r){void 0===t?s.Am.error("Failed to delete contents: ".concat(e.message)):t(e,n,r)},...n})}},60516:function(e,t,n){n.d(t,{I:function(){return a}});var r=n(28894),l=n(129),s=n(97526);async function o(e,t){let{projectRef:n,type:r,name:s,limit:o=10}=e;if(void 0===n)throw Error("projectRef is required for getContent");let{data:a,error:i}=await (0,l.U2)("/platform/projects/{ref}/content",{params:{path:{ref:n},query:{type:r,name:s,limit:o.toString()}},signal:t});return i&&(0,l.S3)(i),{cursor:a.cursor,content:a.data}}let a=function(e){let{projectRef:t,type:n,name:l,limit:a}=e,{enabled:i=!0,...c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.a)(s.$.list(t,{type:n,name:l,limit:a}),e=>{let{signal:r}=e;return o({projectRef:t,type:n,name:l,limit:a},r)},{enabled:i&&void 0!==t,...c})}},47983:function(e,t,n){n.d(t,{a:function(){return s}});var r=n(5359),l=n(9881);function s(){let e=(0,l.l)(),{data:t,isLoading:n,isSuccess:s}=(0,r.Gl)({orgSlug:null==e?void 0:e.slug});return n?{plan:null,usageBillingEnabled:null,isLoading:n,isSuccess:!1}:{plan:null==t?void 0:t.plan,usageBillingEnabled:null==t?void 0:t.usage_billing_enabled,isLoading:n,isSuccess:s}}},13826:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(74234).Z)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},75365:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(74234).Z)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},91001:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(74234).Z)("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]])},78978:function(e,t,n){n.d(t,{B_:function(){return j},_f:function(){return w},aG:function(){return g},av:function(){return b}});var r=n(97458),l=n(72439),s=n(28570),o=n(52983),a=n(9060),i=n(73512),c=n(39957),d=n(43633),u=n(22921),m=n(53486),h=n(79180),p=n(92654),x=n(69133),f=n(82040);function g(e){let{className:t}=e,n=(0,p.Wo)(),s=(0,p.yg)();if(n)return(0,r.jsxs)("button",{className:(0,d.cn)("p-2 bg-overlay flex items-center gap-2 text-xs text-foreground-muted",t),onClick:s,children:[(0,r.jsx)(l.Z,{width:12,height:12}),n.name]})}let j=(0,o.forwardRef)((e,t)=>{let{children:n,className:l,...s}=e;return(0,r.jsx)(u.mY,{ref:t,className:(0,d.cn)("h-full w-full flex flex-col overflow-hidden","[&_[cmdk-group]]:px-2 [&_[cmdk-group]]:!bg-transparent [&_[cmdk-group-heading]]:!bg-transparent [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-border-stronger [&_[cmdk-input]]:h-12","[&_[cmdk-item]_svg]:h-5","[&_[cmdk-item]_svg]:w-5","[&_[cmdk-item]_svg]:stroke-1","[&_[cmdk-input-wrapper]_svg]:h-5","[&_[cmdk-input-wrapper]_svg]:w-5","[&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0",l),...s,children:n})});function v(e){let{resetErrorBoundary:t}=e;return(0,r.jsx)("div",{className:(0,d.cn)("min-h-64","flex items-center justify-center"),children:(0,r.jsxs)("div",{className:"p-10 flex flex-col items-center gap-6 mt-4",children:[(0,r.jsx)(s.Z,{strokeWidth:1.5,size:40}),(0,r.jsx)("p",{className:"text-lg text-center",children:"Sorry, looks like we're having some issues with the command menu!"}),(0,r.jsx)("p",{className:"text-sm text-center",children:"Please try again in a bit."}),(0,r.jsx)(m.z,{size:"tiny",type:"secondary",onClick:t,children:"Try again?"})]})})}function y(e){let{children:t}=e,n=(0,p.EB)();return n?(0,r.jsx)(n,{}):(0,r.jsx)(j,{children:t})}function b(e){let{children:t}=e,n=(0,f.Cc)(),r=(0,f.FX)(),l=o.Children.only(t);return l&&(0,o.isValidElement)(l)?(0,o.cloneElement)(l,{onClick:()=>{var e,t;r(!n),null===(e=(t=l.props).onOpen)||void 0===e||e.call(t,!n)},"aria-haspopup":"dialog","aria-expanded":n,"aria-controls":"command-menu-dialog-content",className:(0,d.cn)("h-10 px-4 py-2","inline-flex items-center justify-center","whitespace-nowrap","rounded-md border border-input bg-background","text-sm font-medium","hover:bg-accent hover:text-accent-foreground","ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50","transition-colors",l.props.className)}):null}function w(e){let{children:t,trigger:n}=e,l=(0,f.Cc)(),s=(0,f.FX)(),u=(0,i.Gc)("sm"),m=(0,f.Qd)(),g=(0,p.Wo)(),j=(0,p.yg)(),b=(0,x.a)(),w=(0,x.A)(),{ref:C}=function(e){let{toggleOpen:t}=e,{ref:n,handleTouchStart:r,handleTouchMove:l,handleTouchEnd:s}=(0,c.Z)({onClose:t}),a=(0,f.Gk)(),i=(0,o.useMemo)(()=>({handleTouchStart:r,handleTouchMove:l,handleTouchEnd:s}),[r,l,s]);return(0,o.useEffect)(()=>{a(i)},[i]),{ref:n}}({toggleOpen:()=>s(!l)});return(0,r.jsxs)(h.Vq,{open:l,onOpenChange:s,children:[n,(0,r.jsx)(h.cZ,{id:"command-menu-dialog-content",hideClose:!0,forceMount:!0,ref:C,onOpenAutoFocus:e=>u&&e.preventDefault(),onInteractOutside:()=>s(!1),onEscapeKeyDown:e=>(e.preventDefault(),b?w(""):g?j():s(!1)),size:m,className:(0,d.cn)("relative flex flex-col my-0 mx-auto rounded-t-lg overflow-hidden","h-[85dvh] mt-[15vh] md:max-h-[500px] md:mt-0 left-0 bottom-0 md:bottom-auto","!animate-in !slide-in-from-bottom-[85%] !duration-300","data-[state=closed]:!animate-out data-[state=closed]:!slide-out-to-bottom","!slide-in-from-left-[0%] :!slide-in-from-top-[0%]","!slide-out-to-left-[0%] !slide-out-to-top-[0%]","md:data-[state=open]:!slide-in-from-bottom-[0%] md:data-[state=closed]:!slide-out-to-bottom-[0%]","md:data-[state=open]:!zoom-in-95 md:data-[state=closed]:!zoom-out-95"),dialogOverlayProps:{className:(0,d.cn)("overflow-hidden flex data-closed:delay-100")},children:(0,r.jsx)(a.SV,{FallbackComponent:v,children:(0,r.jsx)(y,{children:t})})})]})}j.displayName=u.mY.displayName},92654:function(e,t,n){n.d(t,{EB:function(){return u},Qy:function(){return x},SL:function(){return m},Wo:function(){return d},yg:function(){return h}});var r=n(85466),l=n.n(r),s=n(52983),o=n(34653),a=n(42807),i=n(36478),c=n(69133);let d=()=>{let{pagesState:e}=(0,a.D)(),{commandPages:t,pageStack:n}=(0,o.R)(e),r=n.at(-1);return(0,s.useMemo)(()=>r&&t[r]?{...t[r],name:r}:void 0,[t,r])},u=()=>{let e=d();if(e&&(0,i.sG)(e))return e.component},m=()=>{let{pagesState:e}=(0,a.D)(),t=(0,c.A)();return function(n){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.appendPageStack(n),r||t("")}},h=()=>{let{pagesState:e}=(0,a.D)(),{popPageStack:t}=(0,o.R)(e);return t},p=[],x=function(e,t){let{deps:n=p,enabled:r=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{pagesState:i}=(0,a.D)(),{registerNewPage:c}=(0,o.R)(i),d=(0,s.useRef)(n),u=(0,s.useRef)(r),m=(0,s.useRef)();(0,s.useMemo)(()=>{if(!l()(d.current,n)||u.current!==r){var s;null===(s=m.current)||void 0===s||s.call(m),m.current=r?c(e,t):void 0,d.current=n,u.current=r}},[c,e,t,n,r]),(0,s.useEffect)(()=>(m.current=r?c(e,t):void 0,()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.call(m)}),[])}},69133:function(e,t,n){n.d(t,{A:function(){return o},a:function(){return s}});var r=n(34653),l=n(42807);let s=()=>{let{queryState:e}=(0,l.D)(),{query:t}=(0,r.R)(e);return t},o=()=>{let{queryState:e}=(0,l.D)(),{setQuery:t}=(0,r.R)(e);return t}},28289:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(97458),l=n(52983),s=n(17199),o=n(75675);function a(e,t){if(!t.error)return delete e[t.key],e;if(t)return{...e,[t.key]:t.error};throw Error()}function i(e){let{validate:t,...n}=e,[i,c]=(0,l.useReducer)(a,null),d=(0,s.TA)({validateOnBlur:!0,...n,validationSchema:n.validationSchema,initialValues:n.initialValues,onSubmit:n.onSubmit,validate:t||function(){return i}});return(0,r.jsx)("form",{id:n.id,name:n.name,onSubmit:d.handleSubmit,className:n.className,style:n.style,method:"POST",children:(0,r.jsx)(o.o,{values:d.values,errors:d.errors,formContextOnChange:d.handleChange,handleBlur:d.handleBlur,touched:d.touched,fieldLevelValidation:function(e,t){c({key:e,error:t})},children:n.children({errors:d.errors,touched:d.touched,isSubmitting:d.isSubmitting,isValidating:d.isValidating,submitCount:d.submitCount,initialValues:d.initialValues,values:d.values,handleReset:d.handleReset,resetForm:d.resetForm,setFieldValue:d.setFieldValue})})})}}}]);