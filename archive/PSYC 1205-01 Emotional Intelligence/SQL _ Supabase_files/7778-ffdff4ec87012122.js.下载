"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7778],{97778:function(e,t,i){i.d(t,{Z:function(){return ed}});var l=i(97458),a=i(73512),s=i(52983),n=i(34549),r=i(38391),c=i(289),o=i(76026),d=i(56535),u=i(74139),m=i(15631),p=i(40540),h=i(23382),f=i(48631),x=i(11794),b=i(83145),v=i.n(b),j=i(32691),y=i(15647),g=i(51625),_=i(86253),w=i(79007),k=i(36457),N=i(64618),z=i(129),C=i(2626);async function S(e){let{projectRef:t,id:i,isPublic:l,file_size_limit:a,allowed_mime_types:s}=e;if(!t)throw Error("projectRef is required");if(!i)throw Error("Bucket name is required");let n={id:i,public:l};a&&(n.file_size_limit=a),s&&n.allowed_mime_types;let{data:r,error:c}=await (0,z.v_)("/platform/storage/{ref}/buckets",{params:{path:{ref:t}},body:n});return c&&(0,z.S3)(c),r}let Z=function(){let{onSuccess:e,onError:t,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,k.NL)();return(0,N.D)(e=>S(e),{async onSuccess(t,i,a){let{projectRef:s}=i;await l.invalidateQueries(C.m.buckets(s)),await (null==e?void 0:e(t,i,a))},async onError(e,i,l){void 0===t?n.Am.error("Failed to create bucket: ".concat(e.message)):t(e,i,l)},...i})};var E=i(37914),T=i(28289),P=i(60661),O=i(77127),R=i(11108),A=i(75856),I=i(43633),L=i(59599),F=i(53486),B=e=>{var t;let{visible:i,onClose:r}=e,{ref:c}=(0,a.UO)(),o=(0,j.useRouter)(),{mutate:u,isLoading:m}=Z({onSuccess:e=>{n.Am.success("Successfully created bucket ".concat(e.name)),o.push("/project/".concat(c,"/storage/buckets/").concat(e.name)),r()}}),{data:p}=(0,w.k)({projectRef:c},{enabled:d.Qy}),{value:h,unit:f}=(0,_.Ku)(null!==(t=null==p?void 0:p.fileSizeLimit)&&void 0!==t?t:0),x="".concat(h," ").concat(f),[b,k]=(0,s.useState)(g.b.BYTES),[N,z]=(0,s.useState)(!1),C=async e=>{if(!c)return console.error("Project ref is required");u({projectRef:c,id:e.name,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,_.Fm)(e.formatted_size_limit,b):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null})};return(0,s.useEffect)(()=>{i&&(k(g.b.BYTES),z(!1))},[i]),(0,l.jsx)(E.Z,{hideFooter:!0,visible:i,size:"medium",header:"Create storage bucket",onCancel:()=>r(),children:(0,l.jsx)(T.Z,{validateOnBlur:!1,initialValues:{name:"",public:!1,file_size_limit:0,allowed_mime_types:"",has_file_size_limit:!1,formatted_size_limit:0},validate:e=>{let t={};return e.name||(t.name="Please provide a name for your bucket"),e.name&&!/^[a-z0-9.-]+$/.test(e.name)&&(t.name="The name of the bucket must only container lowercase letters, numbers, dots, and hyphens"),e.name&&e.name.endsWith(" ")&&(t.name="The name of the bucket cannot end with a whitespace"),e.has_file_size_limit&&e.formatted_size_limit<0&&(t.formatted_size_limit="File size upload limit has to be at least 0"),"public"===e.name&&(t.name='"public" is a reserved name. Please choose another name'),t},onSubmit:C,children:e=>{let{values:t}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(E.Z.Content,{children:[(0,l.jsx)(P.Z,{id:"name",name:"name",type:"text",className:"w-full",layout:"vertical",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created.",descriptionText:"Only lowercase letters, numbers, dots, and hyphens"}),(0,l.jsxs)("div",{className:"space-y-2 mt-6",children:[(0,l.jsx)(O.Z,{id:"public",name:"public",layout:"flex",label:"Public bucket",descriptionText:"Anyone can read any object without any authorization"}),t.public&&(0,l.jsxs)(R.b,{title:"Public buckets are not protected",variant:"warning",withIcon:!0,children:[(0,l.jsx)("p",{className:"mb-2",children:"Users can read objects in public buckets without any authorization."}),(0,l.jsx)("p",{children:"Row level security (RLS) policies are still required for other operations such as object uploads and deletes."})]})]})]}),(0,l.jsxs)(A.ZP,{open:N,onOpenChange:()=>z(!N),children:[(0,l.jsx)(A.ZP.Trigger,{asChild:!0,children:(0,l.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between border-t border-default",children:[(0,l.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,l.jsx)(y.Z,{size:18,strokeWidth:2,className:(0,I.cn)("text-foreground-light",N&&"rotate-180")})]})}),(0,l.jsx)(A.ZP.Content,{className:"py-4",children:(0,l.jsxs)("div",{className:"w-full space-y-5 px-5",children:[(0,l.jsxs)("div",{className:"space-y-5",children:[(0,l.jsx)(O.Z,{id:"has_file_size_limit",name:"has_file_size_limit",layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"}),t.has_file_size_limit&&(0,l.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,l.jsx)("div",{className:"col-span-8",children:(0,l.jsx)(P.Z,{type:"number",step:1,id:"formatted_size_limit",name:"formatted_size_limit",disabled:!1,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()},descriptionText:"Equivalent to ".concat((0,_.Fm)(t.formatted_size_limit,b).toLocaleString()," bytes.")})}),(0,l.jsx)("div",{className:"col-span-4",children:(0,l.jsx)(L.Z,{id:"size_limit_units",disabled:!1,value:b,onChange:k,children:Object.values(g.b).map(e=>(0,l.jsx)(L.Z.Option,{label:e,value:e,children:(0,l.jsx)("div",{children:e})},e))})}),d.Qy&&(0,l.jsx)("div",{className:"col-span-12",children:(0,l.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket uploads will still be capped at the"," ",(0,l.jsx)(v(),{href:"/project/".concat(c,"/settings/storage"),className:"font-bold underline",children:"global upload limit"})," ","of ",x]})})]})]}),(0,l.jsx)(P.Z,{id:"allowed_mime_types",name:"allowed_mime_types",layout:"vertical",label:"Allowed MIME types",placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc",labelOptional:"Comma separated values",descriptionText:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type."})]})})]}),(0,l.jsx)(E.Z.Separator,{}),(0,l.jsxs)(E.Z.Content,{className:"flex items-center space-x-2 justify-end",children:[(0,l.jsx)(F.z,{type:"default",htmlType:"button",disabled:m,onClick:()=>r(),children:"Cancel"}),(0,l.jsx)(F.z,{type:"primary",htmlType:"submit",loading:m,disabled:m,children:"Save"})]})]})}})})};async function q(e){let{projectRef:t,id:i,isPublic:l,file_size_limit:a,allowed_mime_types:s}=e;if(!t)throw Error("projectRef is required");if(!i)throw Error("Bucket name is requried");let n={public:l};void 0!==a&&(n.file_size_limit=a),void 0!==s&&(n.allowed_mime_types=s);let{data:r,error:c}=await (0,z.r$)("/platform/storage/{ref}/buckets/{id}",{params:{path:{id:i,ref:t}},body:n});return c&&(0,z.S3)(c),r}let M=function(){let{onSuccess:e,onError:t,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,k.NL)();return(0,N.D)(e=>q(e),{async onSuccess(t,i,a){let{projectRef:s}=i;await l.invalidateQueries(C.m.buckets(s)),await (null==e?void 0:e(t,i,a))},async onError(e,i,l){void 0===t?n.Am.error("Failed to update bucket: ".concat(e.message)):t(e,i,l)},...i})};var W=e=>{var t;let{visible:i,bucket:r,onClose:c}=e,{ref:o}=(0,a.UO)(),{mutate:u,isLoading:m}=M({onSuccess:()=>{n.Am.success('Successfully updated bucket "'.concat(null==r?void 0:r.name,'"')),c()}}),{data:p}=(0,w.k)({projectRef:o},{enabled:d.Qy}),{value:h,unit:f}=(0,_.Ku)(null!==(t=null==p?void 0:p.fileSizeLimit)&&void 0!==t?t:0),x="".concat(h," ").concat(f),[b,j]=(0,s.useState)(g.b.BYTES),[k,N]=(0,s.useState)(!1),z=async e=>void 0===r?console.error("Bucket is required"):void 0===o?console.error("Project ref is required"):void u({projectRef:o,id:r.id,isPublic:e.public,file_size_limit:e.has_file_size_limit?(0,_.Fm)(e.formatted_size_limit,b):null,allowed_mime_types:e.allowed_mime_types.length>0?e.allowed_mime_types.split(",").map(e=>e.trim()):null});return(0,s.useEffect)(()=>{if(i){var e;let{unit:t}=(0,_.Ku)(null!==(e=null==r?void 0:r.file_size_limit)&&void 0!==e?e:0);j(t),N(!1)}},[i]),(0,l.jsx)(E.Z,{hideFooter:!0,visible:i,size:"medium",header:'Edit bucket "'.concat(null==r?void 0:r.name,'"'),onCancel:c,children:(0,l.jsx)(T.Z,{validateOnBlur:!1,initialValues:{},validate:e=>{let t={};return e.has_file_size_limit&&e.formatted_size_limit<0&&(t.formatted_size_limit="File size upload limit has to be at least 0"),t},onSubmit:z,children:e=>{let{values:t,resetForm:a}=e;return(0,s.useEffect)(()=>{if(i&&void 0!==r){var e,t,l;let{value:i}=(0,_.Ku)(null!==(e=r.file_size_limit)&&void 0!==e?e:0),s={name:null!==(t=r.name)&&void 0!==t?t:"",public:r.public,file_size_limit:r.file_size_limit,allowed_mime_types:(null!==(l=r.allowed_mime_types)&&void 0!==l?l:[]).join(", "),has_file_size_limit:null!==r.file_size_limit,formatted_size_limit:null!=i?i:0};a({values:s,initialValues:s})}},[i]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(E.Z.Content,{children:[(0,l.jsx)(P.Z,{disabled:!0,id:"name",name:"name",type:"text",className:"w-full",layout:"vertical",label:"Name of bucket",labelOptional:"Buckets cannot be renamed once created."}),(0,l.jsxs)("div",{className:"space-y-2 mt-6",children:[(0,l.jsx)(O.Z,{id:"public",name:"public",layout:"flex",label:"Public bucket",descriptionText:"Anyone can read any object without any authorization"}),(null==r?void 0:r.public)!==t.public&&(0,l.jsx)(R.b,{title:(null==r?void 0:r.public)||!t.public?(null==r?void 0:r.public)&&!t.public?"Warning: Making bucket private":"":"Warning: Making bucket public",variant:"warning",withIcon:!0,children:(0,l.jsx)("p",{className:"mb-2",children:(null==r?void 0:r.public)||!t.public?(null==r?void 0:r.public)&&!t.public?'All objects in "'.concat(null==r?void 0:r.name,'" will be made private and will only be accessible via signed URLs or downloaded with the right authorisation headers'):"":'This will make all objects in the bucket "'.concat(null==r?void 0:r.name,'" public')})})]})]}),(0,l.jsxs)(A.ZP,{open:k,onOpenChange:()=>N(!k),children:[(0,l.jsx)(A.ZP.Trigger,{asChild:!0,children:(0,l.jsxs)("div",{className:"w-full cursor-pointer py-3 px-5 flex items-center justify-between border-t border-default",children:[(0,l.jsx)("p",{className:"text-sm",children:"Additional configuration"}),(0,l.jsx)(y.Z,{size:18,strokeWidth:2,className:(0,I.cn)("text-foreground-light",k&&"rotate-180")})]})}),(0,l.jsx)(A.ZP.Content,{className:"py-4",children:(0,l.jsxs)("div",{className:"w-full space-y-4 px-5",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(O.Z,{id:"has_file_size_limit",name:"has_file_size_limit",layout:"flex",label:"Restrict file upload size for bucket",descriptionText:"Prevent uploading of file sizes greater than a specified limit"}),t.has_file_size_limit&&(0,l.jsxs)("div",{className:"grid grid-cols-12 col-span-12 gap-x-2 gap-y-1",children:[(0,l.jsx)("div",{className:"col-span-8",children:(0,l.jsx)(P.Z,{type:"number",step:1,id:"formatted_size_limit",name:"formatted_size_limit",disabled:!1,onKeyPress:e=>{(e.charCode<48||e.charCode>57)&&e.preventDefault()},descriptionText:"Equivalent to ".concat((0,_.Fm)(t.formatted_size_limit,b).toLocaleString()," bytes.")})}),(0,l.jsx)("div",{className:"col-span-4",children:(0,l.jsx)(L.Z,{id:"size_limit_units",disabled:!1,value:b,onChange:j,children:Object.values(g.b).map(e=>(0,l.jsx)(L.Z.Option,{label:e,value:e,children:(0,l.jsx)("div",{children:e})},e))})}),d.Qy&&(0,l.jsx)("div",{className:"col-span-12 mt-2",children:(0,l.jsxs)("p",{className:"text-foreground-light text-sm",children:["Note: Individual bucket upload will still be capped at the"," ",(0,l.jsx)(v(),{href:"/project/".concat(o,"/settings/storage"),className:"font-bold underline",children:"global upload limit"})," ","of ",x]})})]})]}),(0,l.jsx)(P.Z,{id:"allowed_mime_types",name:"allowed_mime_types",layout:"vertical",label:"Allowed MIME types",placeholder:"e.g image/jpeg, image/png, audio/mpeg, video/mp4, etc",labelOptional:"Comma separated values",descriptionText:"Wildcards are allowed, e.g. image/*. Leave blank to allow any MIME type."})]})})]}),(0,l.jsx)(E.Z.Separator,{}),(0,l.jsxs)(E.Z.Content,{className:"flex items-center space-x-2 justify-end",children:[(0,l.jsx)(F.z,{type:"default",disabled:m,onClick:()=>c(),children:"Cancel"}),(0,l.jsx)(F.z,{type:"primary",htmlType:"submit",loading:m,disabled:m,children:"Save"})]})]})}})})},D=i(86444);async function K(e){let{projectRef:t,id:i}=e;if(!t)throw Error("projectRef is required");if(!i)throw Error("Bucket name is requried");let{data:l,error:a}=await (0,z.v_)("/platform/storage/{ref}/buckets/{id}/empty",{params:{path:{id:i,ref:t}}});return a&&(0,z.S3)(a),l}let V=function(){let{onSuccess:e,onError:t,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,k.NL)();return(0,N.D)(e=>K(e),{async onSuccess(t,i,a){let{projectRef:s}=i;await l.invalidateQueries(C.m.buckets(s)),await (null==e?void 0:e(t,i,a))},async onError(e,i,l){void 0===t?n.Am.error("Failed to empty bucket: ".concat(e.message)):t(e,i,l)},...i})};var Q=i(15518);let U=e=>{let{visible:t=!1,bucket:i,onClose:s}=e,{ref:r}=(0,a.UO)(),{fetchFolderContents:c}=(0,u.H)(),{mutate:o,isLoading:d}=V({onSuccess:async()=>{void 0!==i&&(await c(i.id,i.name,-1),n.Am.success("Successfully deleted bucket ".concat(i.name)),s())}}),m=async()=>r?i?void o({projectRef:r,id:i.id}):console.error("No bucket is selected"):console.error("Project ref is required");return(0,l.jsx)(Q.Z,{variant:"destructive",size:"small",title:"Confirm to delete all contents from ".concat(null==i?void 0:i.name),confirmLabel:"Empty bucket",visible:t,onCancel:()=>s(),onConfirm:m,alert:{title:"This action cannot be undone",description:"The contents of your bucket cannot be recovered once deleted"},children:(0,l.jsxs)("p",{className:"text-sm",children:['Are you sure you want to empty the bucket "',null==i?void 0:i.name,'"?']})})};var X=i(2861),Y=i(61115),G=i(64245),J=i(94281),$=i(33880),H=i(19405),ee=i(5817),et=i(71607),ei=i.n(et),el=i(35323),ea=i(79863),es=i(26597),en=i(33971),er=i(15011),ec=e=>{let{bucket:t,projectRef:i="",isSelected:a=!1,onSelectEmptyBucket:s=ei(),onSelectDeleteBucket:n=ei(),onSelectEditBucket:r=ei()}=e,c=(0,J.Xo)(p.KA.STORAGE_WRITE,"*");return(0,l.jsxs)("div",{className:(0,I.cn)("group flex items-center justify-between rounded-md",a&&"text-foreground bg-surface-100"),children:[(0,l.jsx)(v(),{href:"/project/".concat(i,"/storage/buckets/").concat(encodeURIComponent(t.id)),className:(0,I.cn)("py-1 px-3",a?"w-[88%]":"w-full"),children:(0,l.jsxs)("div",{className:"flex items-center justify-between space-x-2 truncate w-full",children:[(0,l.jsx)("p",{className:"text-sm group-hover:text-foreground transition truncate ".concat(a?"text-foreground":"text-foreground-light"),title:t.name,children:t.name}),t.public&&(0,l.jsx)(en.C,{variant:"warning",children:"Public"})]})}),c&&a?(0,l.jsxs)(er.h_,{children:[(0,l.jsx)(er.$F,{asChild:!0,children:(0,l.jsx)(F.z,{type:"text",icon:(0,l.jsx)(y.Z,{}),className:"mr-1 p-0.5"})}),(0,l.jsxs)(er.AW,{side:"bottom",align:"start",children:[(0,l.jsxs)(er.Xi,{className:"space-x-2",onClick:()=>r(),children:[(0,l.jsx)(el.Z,{size:14}),(0,l.jsx)("p",{children:"Edit bucket"})]},"toggle-private"),(0,l.jsx)(er.VD,{}),(0,l.jsxs)(er.Xi,{className:"space-x-2",onClick:()=>s(),children:[(0,l.jsx)(ea.Z,{size:14}),(0,l.jsx)("p",{children:"Empty bucket"})]},"empty-bucket"),(0,l.jsxs)(er.Xi,{className:"space-x-2",onClick:()=>n(),children:[(0,l.jsx)(es.Z,{size:14}),(0,l.jsx)("p",{children:"Delete bucket"})]},"delete-bucket")]})]}):(0,l.jsx)("div",{className:"w-5"})]},t.id)},eo=()=>{let e=(0,j.useRouter)(),{ref:t,bucketId:i}=(0,a.UO)(),n=(0,c.Vm)(),r=(null==n?void 0:n.parent_project_ref)!==void 0,[o,d]=(0,s.useState)(""),[u,m]=(0,s.useState)(!1),[b,y]=(0,s.useState)(),[g,_]=(0,s.useState)(),[w,k]=(0,s.useState)(),N=(0,J.Xo)(p.KA.STORAGE_WRITE,"*"),[z,C]=(0,h._)("storage-explorer-sort","created-at"),S=e.pathname.split("/")[4],{data:Z,error:E,isLoading:T,isError:P,isSuccess:O}=(0,G.K)({projectRef:t}),R=null!=Z?Z:[],A="alphabetical"===z?R.sort((e,t)=>e.name.toLowerCase().trim().localeCompare(t.name.toLowerCase().trim())):R.sort((e,t)=>new Date(t.created_at)>new Date(e.created_at)?-1:1),I=o.length>1?A.filter(e=>e.name.includes(o.trim())):A,L=(null==E?void 0:E.message.includes("Tenant config"))&&r;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)($.ZP,{type:"pills",className:"my-6 flex flex-grow flex-col",children:[(0,l.jsxs)("div",{className:"mb-6 mx-5 flex flex-col gap-y-1.5",children:[(0,l.jsx)(X.u,{block:!0,type:"default",icon:(0,l.jsx)(f.Z,{}),disabled:!N,style:{justifyContent:"start"},onClick:()=>m(!0),tooltip:{content:{side:"bottom",text:N?void 0:"You need additional permissions to create buckets"}},children:"New bucket"}),(0,l.jsx)(ee.nM,{className:"px-0",children:(0,l.jsx)(ee.nn,{name:"search-buckets","aria-labelledby":"Search buckets",placeholder:"Search buckets...",value:o,onChange:e=>{d(e.target.value)},children:(0,l.jsxs)(ee.ZY,{value:z,onValueChange:e=>C(e),children:[(0,l.jsx)(ee.IR,{value:"alphabetical",className:"flex gap-2",children:"Alphabetical"},"alphabetical"),(0,l.jsx)(ee.IR,{value:"created-at",children:"Created at"},"created-at")]})})})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"mx-3",children:[(0,l.jsx)($.ZP.Group,{title:(0,l.jsx)("span",{className:"uppercase font-mono",children:"All buckets"})}),T&&(0,l.jsxs)("div",{className:"space-y-2 mx-2",children:[(0,l.jsx)(Y.Z,{className:"!py-2.5"}),(0,l.jsx)(Y.Z,{className:"!py-2.5"}),(0,l.jsx)(Y.Z,{className:"!py-2.5"})]}),P&&(0,l.jsx)("div",{className:"px-2",children:(0,l.jsxs)(H.bZ,{variant:L?"default":"warning",children:[(0,l.jsx)(H.Cd,{className:"text-xs tracking-normal",children:L?"Storage is not available on preview branches for now":"Failed to fetch buckets"}),(0,l.jsx)(H.X,{className:"text-xs",children:L?"We're actively looking into making this available on preview branches":"Please refresh to try again"})]})}),O&&(0,l.jsxs)(l.Fragment,{children:[0===R.length&&(0,l.jsx)(ee.Cf,{className:"mx-2",title:"No buckets available",description:"Buckets that you create will appear here"}),o.length>0&&0===I.length&&(0,l.jsx)(ee.Cf,{className:"mx-2",title:"No results found",description:'Your search for "'.concat(o,'" did not return any results')}),I.map((e,a)=>{let s=i===e.id;return(0,l.jsx)(ec,{bucket:e,projectRef:t,isSelected:s,onSelectEmptyBucket:()=>_(e),onSelectDeleteBucket:()=>k(e),onSelectEditBucket:()=>y(e)},"".concat(a,"_").concat(e.id))})]})]}),(0,l.jsx)("div",{className:"h-px w-full bg-border"}),(0,l.jsxs)("div",{className:"mx-3",children:[(0,l.jsx)($.ZP.Group,{title:(0,l.jsx)("span",{className:"uppercase font-mono",children:"Configuration"})}),(0,l.jsx)(v(),{href:"/project/".concat(t,"/storage/policies"),children:(0,l.jsx)($.ZP.Item,{rounded:!0,active:"policies"===S,children:(0,l.jsx)("p",{className:"truncate",children:"Policies"})})}),(0,l.jsx)(v(),{href:"/project/".concat(t,"/settings/storage"),children:(0,l.jsx)($.ZP.Item,{rounded:!0,children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("p",{className:"truncate",children:"Settings"}),(0,l.jsx)(x.Z,{strokeWidth:1,className:"h-4 w-4"})]})})})]})]})]}),(0,l.jsx)(B,{visible:u,onClose:()=>m(!1)}),(0,l.jsx)(W,{visible:void 0!==b,bucket:b,onClose:()=>y(void 0)}),(0,l.jsx)(U,{visible:void 0!==g,bucket:g,onClose:()=>_(void 0)}),(0,l.jsx)(D.Iw,{visible:void 0!==w,bucket:w,onClose:()=>k(void 0)})]})},ed=(0,o.Q)(e=>{var t;let{title:i,children:o}=e,{ref:p}=(0,a.UO)(),h=(0,c.Vm)(),f=(0,u.H)(),{data:x,isLoading:b}=(0,r.zR)({projectRef:p}),v=null==x?void 0:null===(t=x.app_config)||void 0===t?void 0:t.endpoint,{serviceKey:j}=(0,r.Pb)(x),y=(null==h?void 0:h.status)===d.S.INACTIVE;(0,s.useEffect)(()=>{!b&&v&&(null==j?void 0:j.api_key)&&g(v,j.api_key)},[b,p,v,null==j?void 0:j.api_key]);let g=async(e,t)=>{if(!y){if(e){var i,l;let a=null!==(l=null==x?void 0:null===(i=x.app_config)||void 0===i?void 0:i.protocol)&&void 0!==l?l:"https";f.initStore(p,e,t,a)}else n.Am.error("Failed to fetch project configuration. Try refreshing your browser, or reach out to us at support@supabase.io")}};return(0,l.jsx)(m.Z,{title:i||"Storage",product:"Storage",productMenu:(0,l.jsx)(eo,{}),children:o})})},79863:function(e,t,i){i.d(t,{Z:function(){return l}});let l=(0,i(74234).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},75856:function(e,t,i){var l=i(97458),a=i(99517);i(52983);var s=i(92334);let n=e=>{let{open:t,children:i,className:s,...n}=e;return(0,l.jsx)(a.fC,{asChild:n.asChild,defaultOpen:n.defaultOpen,open:t,onOpenChange:n.onOpenChange,disabled:n.disabled,className:s,children:i})};n.Trigger=function(e){let{children:t,asChild:i}=e;return(0,l.jsx)(a.xz,{asChild:i,children:t})},n.Content=function(e){let{asChild:t,children:i,className:n}=e,r=(0,s.Z)("collapsible");return(0,l.jsx)(a.VY,{asChild:t,className:[r.content,n].join(" "),children:i})},t.ZP=n},23382:function(e,t,i){i.d(t,{Nr:function(){return s},_:function(){return u}});var l=i(52983);function a(e,t){window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:t}))}function s(e,t){let[i,a]=l.useState(e);return l.useEffect(()=>{let i=setTimeout(()=>{a(e)},t);return()=>{clearTimeout(i)}},[e,t]),i}let n=(e,t)=>{let i=JSON.stringify(t);window.localStorage.setItem(e,i),a(e,i)},r=e=>{window.localStorage.removeItem(e),a(e,null)},c=e=>window.localStorage.getItem(e),o=e=>(window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)),d=()=>{throw Error("useLocalStorage is a client-only hook")};function u(e,t){let i=l.useSyncExternalStore(o,()=>c(e),d),a=l.useCallback(t=>{try{let l="function"==typeof t?t(JSON.parse(i)):t;null==l?r(e):n(e,l)}catch(e){console.warn(e)}},[e,i]);return l.useEffect(()=>{null===c(e)&&void 0!==t&&n(e,t)},[e,t]),[i?JSON.parse(i):t,a]}}}]);